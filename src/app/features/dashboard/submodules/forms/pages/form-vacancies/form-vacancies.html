<div class="contenedor">
  @let escolaridadVal = formHojaDeVida2.get('escolaridad')?.value;
  @let estadoCivilVal = formHojaDeVida2.get('estadoCivil')?.value;

  @let viveConyugeVal = formHojaDeVida2.get('viveConyuge')?.value;
  @let elPadreViveVal = formHojaDeVida2.get('elPadreVive')?.value;
  @let madreViveVal = formHojaDeVida2.get('madreVive')?.value;

  @let experienciaVal = formHojaDeVida2.get('experienciaLaboral')?.value;
  @let deseaGenerarVal = formHojaDeVida2.get('deseaGenerar')?.value;
  @let tieneVehiculoVal = formHojaDeVida2.get('tieneVehiculo')?.value;
  @let estaTrabajandoVal = formHojaDeVida2.get('estaTrabajando')?.value;
  @let tieneHermanosVal = formHojaDeVida2.get('tieneHermanos')?.value;

  @let numHijos = (formHojaDeVida2.get('numHijosDependientes')?.value ?? 0);

  <div class="head">
    <h1>Formulario de contratación</h1>
  </div>

  <div class="fila1">
    <form
      class="formulario formulario2"
      [formGroup]="formHojaDeVida2"
      id="formulario"
      autocomplete="off"
      (ngSubmit)="imprimirInformacion2()">

      <!-- =========================================================
           TEMPLATE REUTILIZABLE PARA DIRECCIONES CON DIALOG
      ========================================================= -->
      <ng-template
        #addressBuilderTpl
        let-label="label"
        let-control="control"
        let-placeholder="placeholder"
        let-required="required">

        <mat-form-field appearance="outline">
          <mat-label>{{ label }}</mat-label>

          <input
            matInput
            [formControlName]="control"
            [placeholder]="placeholder || 'Construir dirección...'"
            readonly
            (click)="openAddressModal(control, label)" />

          <button
            mat-icon-button
            matSuffix
            type="button"
            (click)="openAddressModal(control, label); $event.preventDefault(); $event.stopPropagation()"
            aria-label="Construir dirección">
            <mat-icon>edit_location_alt</mat-icon>
          </button>

          <button
            mat-icon-button
            matSuffix
            type="button"
            (click)="formHojaDeVida2.get(control)?.setValue(''); formHojaDeVida2.get(control)?.markAsTouched(); $event.preventDefault(); $event.stopPropagation()"
            aria-label="Limpiar dirección">
            <mat-icon>close</mat-icon>
          </button>

          <mat-hint>Usa el asistente para estandarizar la dirección.</mat-hint>

          @if (shouldShowError(control)) {
          <!-- Mensaje general (humano) -->
          <mat-error>{{ getErrorMessage(control) }}</mat-error>
          }

          <!-- Mensajes específicos para dirección (por si quieres forzar "usa el asistente") -->
          @if (
          (required && formHojaDeVida2.get(control)?.hasError('required')) &&
          (formHojaDeVida2.get(control)?.touched ||
          formHojaDeVida2.get(control)?.dirty)
          ) {
          <mat-error>La dirección es obligatoria.</mat-error>
          }

          @if (
          (formHojaDeVida2.get(control)?.hasError('pattern') ||
          formHojaDeVida2.get(control)?.hasError('maxlength') ||
          formHojaDeVida2.get(control)?.hasError('minlength')) &&
          (formHojaDeVida2.get(control)?.touched ||
          formHojaDeVida2.get(control)?.dirty)
          ) {
          <mat-error>Dirección inválida. Usa el asistente para
            construirla.</mat-error>
          }
        </mat-form-field>
      </ng-template>

      <!-- Resumen simple cuando haya errores -->
      @if (formHojaDeVida2.invalid && (formHojaDeVida2.touched ||
      formHojaDeVida2.dirty)) {
      <div
        style="grid-column:1/-1; margin:0 0 12px 0; padding:10px 12px; border:1px solid #fecaca; background:#fef2f2; border-radius:12px; color:#991b1b; font-weight:700;">
        Hay campos pendientes por completar. Revisa los mensajes en rojo.
      </div>
      }

      <!-- Errores cruzados del FormGroup -->
      @if (formHojaDeVida2.errors && (formHojaDeVida2.touched ||
      formHojaDeVida2.dirty)) {
      <div
        style="grid-column:1/-1; margin:0 0 12px 0; padding:10px 12px; border:1px solid #fee2e2; background:#fff7ed; border-radius:12px; color:#9a3412; font-weight:700;">
        @if (formHojaDeVida2.errors['expeditionBeforeBirth']) {
        <div>La fecha de expedición no puede ser anterior a la fecha de
          nacimiento.</div>
        }
        @if (formHojaDeVida2.errors['expeditionTooEarly']) {
        <div>La fecha de expedición no es válida (debe ser posterior a una edad
          mínima).</div>
        }
      </div>
      }

      <div class="stepper-scroll">

        <!-- ✅ Progreso del stepper -->
        <div style="margin: 8px 0 14px 0;">
          <mat-progress-bar mode="determinate"
            [value]="stepperProgress"></mat-progress-bar>

          <div
            style="display:flex; justify-content:space-between; align-items:center; margin-top:6px; font-size:12px; color:#6b7280;">
            <div>
              Paso {{ stepperIndex }} de {{ stepperTotal }}
            </div>

            <div style="font-weight:600; color:#111827;">
              {{ stepperProgress | number:'1.0-0' }}%
            </div>
          </div>
        </div>

        <mat-horizontal-stepper
          #stepper="matStepper"
          [linear]="false"
          animationDuration="250ms">

          <!-- ========================================================= -->
          <!-- STEP 1: IDENTIFICACIÓN Y CONTACTO -->
          <!-- ========================================================= -->
          <mat-step>
            <ng-template matStepLabel>Datos personales</ng-template>

            <div class="title">
              <h1>Datos personales</h1>
              <p style="margin:4px 0 0 0; font-size:12px; color:#6b7280;">
                Identificación, contacto, residencia y datos básicos.
              </p>
            </div>

            <!-- Identificación -->
            <h2
              style="margin: 10px 0 6px 0; font-size: 14px; font-weight: 800; color:#111827;">
              Identificación
            </h2>

            <div class="datos">
              <mat-form-field appearance="outline">
                <mat-label>Tipo de documento</mat-label>
                <mat-select formControlName="tipoDoc">
                  @for (tipoDocItem of tipoDocs; track tipoDocItem.abbreviation)
                  {
                  <mat-option [value]="tipoDocItem.abbreviation">
                    {{ tipoDocItem.description }}
                  </mat-option>
                  }
                </mat-select>
                @if (shouldShowError('tipoDoc')) {
                <mat-error>{{ getErrorMessage('tipoDoc') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Número de documento</mat-label>
                <input type="text" matInput formControlName="numeroCedula"
                  placeholder="Ej: 10058478963" />
                @if (shouldShowError('numeroCedula')) {
                <mat-error>{{ getErrorMessage('numeroCedula') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Primer apellido</mat-label>
                <input type="text" matInput formControlName="pApellido"
                  placeholder="Ej: Peláez" />
                @if (shouldShowError('pApellido')) {
                <mat-error>{{ getErrorMessage('pApellido') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Segundo apellido</mat-label>
                <input type="text" matInput formControlName="sApellido"
                  placeholder="Opcional" />
                @if (shouldShowError('sApellido')) {
                <mat-error>{{ getErrorMessage('sApellido') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Primer nombre</mat-label>
                <input type="text" matInput formControlName="pNombre"
                  placeholder="Ej: Juan" />
                @if (shouldShowError('pNombre')) {
                <mat-error>{{ getErrorMessage('pNombre') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Segundo nombre</mat-label>
                <input type="text" matInput formControlName="sNombre"
                  placeholder="Opcional" />
                @if (shouldShowError('sNombre')) {
                <mat-error>{{ getErrorMessage('sNombre') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Sexo</mat-label>
                <mat-select formControlName="genero">
                  @for (generoItem of generos; track generoItem) {
                  <mat-option [value]="generoItem">{{ generoItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('genero')) {
                <mat-error>{{ getErrorMessage('genero') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Estado civil</mat-label>
                <mat-select formControlName="estadoCivil">
                  @for (estadoItem of estadosCiviles; track estadoItem.codigo) {
                  <mat-option [value]="estadoItem.codigo">
                    {{ estadoItem.descripcion }}
                  </mat-option>
                  }
                </mat-select>
                @if (shouldShowError('estadoCivil')) {
                <mat-error>{{ getErrorMessage('estadoCivil') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Correo electrónico</mat-label>
                <input type="email" matInput formControlName="correo"
                  placeholder="Ej: ejemplo@gmail.com" />
                @if (shouldShowError('correo')) {
                <mat-error>{{ getErrorMessage('correo') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Número de celular</mat-label>
                <input type="tel" matInput formControlName="numCelular"
                  placeholder="Ej: 3147859841" />
                @if (shouldShowError('numCelular')) {
                <mat-error>{{ getErrorMessage('numCelular') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Número de WhatsApp</mat-label>
                <input type="tel" matInput formControlName="numWha"
                  placeholder="Ej: 3175987256" />
                @if (shouldShowError('numWha')) {
                <mat-error>{{ getErrorMessage('numWha') }}</mat-error>
                }
              </mat-form-field>
            </div>

            <!-- Contacto -->
            <h2
              style="margin: 16px 0 6px 0; font-size: 14px; font-weight: 800; color:#111827;">
              Contacto
            </h2>

            <div class="datos">
              <mat-form-field appearance="outline">
                <mat-label>Contacto de emergencia</mat-label>
                <input matInput formControlName="familiarEmergencia"
                  placeholder="Nombre y apellido" />
                @if (shouldShowError('familiarEmergencia')) {
                <mat-error>{{ getErrorMessage('familiarEmergencia')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Parentesco</mat-label>
                <mat-select formControlName="parentescoFamiliarEmergencia">
                  @for (parentescoItem of listaParentescosFamiliares; track
                  parentescoItem) {
                  <mat-option [value]="parentescoItem">{{ parentescoItem
                    }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('parentescoFamiliarEmergencia')) {
                <mat-error>{{ getErrorMessage('parentescoFamiliarEmergencia')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Dirección</mat-label>
                <input matInput formControlName="direccionFamiliarEmergencia" />
                @if (shouldShowError('direccionFamiliarEmergencia')) {
                <mat-error>{{ getErrorMessage('direccionFamiliarEmergencia')
                  }}</mat-error>
                } 
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Barrio o municipio</mat-label>
                <input matInput formControlName="barrioFamiliarEmergencia" />
                @if (shouldShowError('barrioFamiliarEmergencia')) {
                <mat-error>{{ getErrorMessage('barrioFamiliarEmergencia')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Teléfono del contacto</mat-label>
                <input matInput formControlName="telefonoFamiliarEmergencia"
                  type="tel" />
                @if (shouldShowError('telefonoFamiliarEmergencia')) {
                <mat-error>{{ getErrorMessage('telefonoFamiliarEmergencia')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Ocupación</mat-label>
                <mat-select formControlName="ocupacionFamiliar_Emergencia">
                  @for (ocupacionItem of Ocupacion; track ocupacionItem) {
                  <mat-option [value]="ocupacionItem">{{ ocupacionItem
                    }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('ocupacionFamiliar_Emergencia')) {
                <mat-error>{{ getErrorMessage('ocupacionFamiliar_Emergencia')
                  }}</mat-error>
                }
              </mat-form-field>
            </div>

            <!-- Residencia -->
            <h2
              style="margin: 16px 0 6px 0; font-size: 14px; font-weight: 800; color:#111827;">
              Residencia
            </h2>

            <div class="datos">
              <mat-form-field appearance="outline">
                <mat-label>Departamento</mat-label>
                <mat-select formControlName="departamento">
                  @for (departamentoItem of datos; track
                  departamentoItem.departamento) {
                  <mat-option [value]="departamentoItem.departamento">
                    {{ departamentoItem.departamento }}
                  </mat-option>
                  }
                </mat-select>
                @if (shouldShowError('departamento')) {
                <mat-error>{{ getErrorMessage('departamento') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Municipio</mat-label>
                <mat-select formControlName="ciudad">
                  @for (ciudadItem of ciudadesResidencia; track ciudadItem) {
                  <mat-option [value]="ciudadItem">{{ ciudadItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('ciudad')) {
                <mat-error>{{ getErrorMessage('ciudad') }}</mat-error>
                }
              </mat-form-field>

              <!--direccionResidencia
              -->
              <mat-form-field appearance="outline">
                <mat-label>Direccion de residencia</mat-label>
                <input matInput formControlName="direccionResidencia"
                  placeholder="Ej: Calle 123 " />
                @if (shouldShowError('direccionResidencia')) {
                <mat-error>{{ getErrorMessage('direccionResidencia') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Barrio / Zona</mat-label>
                <input matInput formControlName="zonaResidencia"
                  placeholder="Ej: Barrio La Paz" />
                @if (shouldShowError('zonaResidencia')) {
                <mat-error>{{ getErrorMessage('zonaResidencia') }}</mat-error>
                }
              </mat-form-field>

              

              <mat-form-field appearance="outline">
                <mat-label>Tiempo viviendo en la zona</mat-label>
                <mat-select formControlName="tiempoResidenciaZona">
                  @for (tiempoItem of haceCuantoViveEnlaZona; track tiempoItem)
                  {
                  <mat-option [value]="tiempoItem">{{ tiempoItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('tiempoResidenciaZona')) {
                <mat-error>{{ getErrorMessage('tiempoResidenciaZona')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Residencia anterior</mat-label>
                <input matInput formControlName="lugarAnteriorResidencia"
                  placeholder="Ej: Bogotá" />
                @if (shouldShowError('lugarAnteriorResidencia')) {
                <mat-error>{{ getErrorMessage('lugarAnteriorResidencia')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Motivo de cambio</mat-label>
                <input matInput formControlName="razonCambioResidencia"
                  placeholder="Ej: Razones personales" />
                @if (shouldShowError('razonCambioResidencia')) {
                <mat-error>{{ getErrorMessage('razonCambioResidencia')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Zonas del país que conoce</mat-label>
                <input matInput formControlName="zonasConocidas"
                  placeholder="Ej: Costa, Andina" />
                @if (shouldShowError('zonasConocidas')) {
                <mat-error>{{ getErrorMessage('zonasConocidas') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Dónde le gustaría vivir</mat-label>
                <input matInput formControlName="preferenciaResidencia"
                  placeholder="Ej: En el campo" />
                @if (shouldShowError('preferenciaResidencia')) {
                <mat-error>{{ getErrorMessage('preferenciaResidencia')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Oficina</mat-label>
                <mat-select formControlName="oficina">
                  @for (oficinaItem of oficinas; track oficinaItem) {
                  <mat-option [value]="oficinaItem">{{ oficinaItem
                    }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('oficina')) {
                <mat-error>{{ getErrorMessage('oficina') }}</mat-error>
                }
              </mat-form-field>
            </div>

            <!-- Documento y nacimiento -->
            <h2
              style="margin: 16px 0 6px 0; font-size: 14px; font-weight: 800; color:#111827;">
              Documento y nacimiento
            </h2>

            <div class="datos">
              <mat-form-field appearance="outline">
                <mat-label>Fecha de expedición</mat-label>
                <input
                  matInput
                  [matDatepicker]="expedicionCCPicker"
                  formControlName="fechaExpedicionCC"
                  (focus)="expedicionCCPicker.open()" />
                <mat-datepicker-toggle matSuffix
                  [for]="expedicionCCPicker"></mat-datepicker-toggle>
                <mat-datepicker #expedicionCCPicker></mat-datepicker>

                @if (shouldShowError('fechaExpedicionCC')) {
                <mat-error>{{ getErrorMessage('fechaExpedicionCC')
                  }}</mat-error>
                }
                @if (
                formHojaDeVida2.get('fechaExpedicionCC')?.hasError('matDatepickerParse')
                &&
                (formHojaDeVida2.get('fechaExpedicionCC')?.touched ||
                formHojaDeVida2.get('fechaExpedicionCC')?.dirty)
                ) {
                <mat-error>Fecha inválida.</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Depto. de expedición</mat-label>
                <mat-select formControlName="departamentoExpedicionCC">
                  @for (departamentoItem of datos; track
                  departamentoItem.departamento) {
                  <mat-option [value]="departamentoItem.departamento">
                    {{ departamentoItem.departamento }}
                  </mat-option>
                  }
                </mat-select>
                @if (shouldShowError('departamentoExpedicionCC')) {
                <mat-error>{{ getErrorMessage('departamentoExpedicionCC')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Municipio de expedición</mat-label>
                <mat-select formControlName="municipioExpedicionCC">
                  @for (ciudadItem of ciudadesExpedicionCC; track ciudadItem) {
                  <mat-option [value]="ciudadItem">{{ ciudadItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('municipioExpedicionCC')) {
                <mat-error>{{ getErrorMessage('municipioExpedicionCC')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Fecha de nacimiento</mat-label>
                <input
                  matInput
                  [matDatepicker]="pickerNacimiento"
                  formControlName="fechaNacimiento"
                  (focus)="pickerNacimiento.open()" />
                <mat-datepicker-toggle matSuffix
                  [for]="pickerNacimiento"></mat-datepicker-toggle>
                <mat-datepicker #pickerNacimiento></mat-datepicker>

                @if (shouldShowError('fechaNacimiento')) {
                <mat-error>{{ getErrorMessage('fechaNacimiento') }}</mat-error>
                }
                @if (
                formHojaDeVida2.get('fechaNacimiento')?.hasError('matDatepickerParse')
                &&
                (formHojaDeVida2.get('fechaNacimiento')?.touched ||
                formHojaDeVida2.get('fechaNacimiento')?.dirty)
                ) {
                <mat-error>Fecha inválida.</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Depto. de nacimiento</mat-label>
                <mat-select formControlName="departamentoNacimiento">
                  @for (departamentoItem of datos; track
                  departamentoItem.departamento) {
                  <mat-option [value]="departamentoItem.departamento">
                    {{ departamentoItem.departamento }}
                  </mat-option>
                  }
                </mat-select>
                @if (shouldShowError('departamentoNacimiento')) {
                <mat-error>{{ getErrorMessage('departamentoNacimiento')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Municipio de nacimiento</mat-label>
                <mat-select formControlName="municipioNacimiento">
                  @for (ciudadItem of ciudadesNacimiento; track ciudadItem) {
                  <mat-option [value]="ciudadItem">{{ ciudadItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('municipioNacimiento')) {
                <mat-error>{{ getErrorMessage('municipioNacimiento')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>RH</mat-label>
                <mat-select formControlName="rh">
                  @for (rhItem of listatiposdesangre; track rhItem) {
                  <mat-option [value]="rhItem">{{ rhItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('rh')) {
                <mat-error>{{ getErrorMessage('rh') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Lateralidad</mat-label>
                <mat-select formControlName="lateralidad">
                  @for (manoItem of listamanos; track manoItem.mano) {
                  <mat-option [value]="manoItem.mano">{{ manoItem.descripcion
                    }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('lateralidad')) {
                <mat-error>{{ getErrorMessage('lateralidad') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>¿Estudia actualmente?</mat-label>
                <mat-select formControlName="estudiaActualmente">
                  @for (opcionItem of opcionBinaria; track opcionItem.value) {
                  <mat-option [value]="opcionItem.value">{{ opcionItem.display
                    }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('estudiaActualmente')) {
                <mat-error>{{ getErrorMessage('estudiaActualmente')
                  }}</mat-error>
                }
              </mat-form-field>
            </div>

            <div
              style="display:flex; gap:10px; justify-content:flex-end; margin-top:12px;">
              <button type="button" matButton="filled"
                matStepperNext>Siguiente</button>
            </div>
          </mat-step>

          <!-- ========================================================= -->
          <!-- STEP 2: EDUCACIÓN Y TALLAS -->
          <!-- ========================================================= -->
          <mat-step>
            <ng-template matStepLabel>Educación y tallas</ng-template>

            <div class="title">
              <h1>Educación</h1>
              <p style="margin:4px 0 0 0; font-size:12px; color:#6b7280;">
                Formación académica y estudios adicionales.
              </p>
            </div>

            <h2
              style="margin: 10px 0 6px 0; font-size: 14px; font-weight: 800; color:#111827;">
              Formación principal
            </h2>

            <div class="datos">
              <mat-form-field appearance="outline">
                <mat-label>Escolaridad</mat-label>
                <mat-select formControlName="escolaridad">
                  @for (nivelItem of listaEscolaridad; track nivelItem) {
                  <mat-option [value]="nivelItem">{{ nivelItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('escolaridad')) {
                <mat-error>{{ getErrorMessage('escolaridad') }}</mat-error>
                }
              </mat-form-field>

              @if (escolaridadVal !== 'SIN ESTUDIOS') {
              <mat-form-field appearance="outline">
                <mat-label>Institución</mat-label>
                <input matInput formControlName="nombreInstitucion" />
                @if (shouldShowError('nombreInstitucion')) {
                <mat-error>{{ getErrorMessage('nombreInstitucion')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Año de finalización</mat-label>
                <input
                  matInput
                  [matDatepicker]="anoFinalizacionPicker"
                  formControlName="anoFinalizacion"
                  (focus)="anoFinalizacionPicker.open()" />
                <mat-datepicker-toggle matSuffix
                  [for]="anoFinalizacionPicker"></mat-datepicker-toggle>
                <mat-datepicker #anoFinalizacionPicker startView="multi-year"
                  panelClass="example-year-picker"></mat-datepicker>

                @if (shouldShowError('anoFinalizacion')) {
                <mat-error>{{ getErrorMessage('anoFinalizacion') }}</mat-error>
                }
                @if (
                formHojaDeVida2.get('anoFinalizacion')?.hasError('matDatepickerParse')
                &&
                (formHojaDeVida2.get('anoFinalizacion')?.touched ||
                formHojaDeVida2.get('anoFinalizacion')?.dirty)
                ) {
                <mat-error>Fecha inválida.</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Título obtenido</mat-label>
                <input matInput formControlName="tituloObtenido" />
                @if (shouldShowError('tituloObtenido')) {
                <mat-error>{{ getErrorMessage('tituloObtenido') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Estudios adicionales</mat-label>
                <mat-select formControlName="estudiosExtrasSelect" multiple>
                  @for (nivelItem of cursosDespuesColegio; track nivelItem) {
                  <mat-option [value]="nivelItem">{{ nivelItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('estudiosExtrasSelect')) {
                <mat-error>{{ getErrorMessage('estudiosExtrasSelect')
                  }}</mat-error>
                }

              </mat-form-field>

              }
            </div>

            <div class="title" style="margin-top: 14px;">
              <h1>Tallas</h1>
              <p style="margin:4px 0 0 0; font-size:12px; color:#6b7280;">
                Para dotación y uniforme.
              </p>
            </div>

            <div class="datos">
              <mat-form-field appearance="outline">
                <mat-label>Chaqueta</mat-label>
                <mat-select formControlName="tallaChaqueta">
                  @for (tallaItem of tallas; track tallaItem) {
                  <mat-option [value]="tallaItem">{{ tallaItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('tallaChaqueta')) {
                <mat-error>{{ getErrorMessage('tallaChaqueta') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Pantalón</mat-label>
                <mat-select formControlName="tallaPantalon">
                  @for (tallaItem of tallas; track tallaItem) {
                  <mat-option [value]="tallaItem">{{ tallaItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('tallaPantalon')) {
                <mat-error>{{ getErrorMessage('tallaPantalon') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Camisa</mat-label>
                <mat-select formControlName="tallaCamisa">
                  @for (tallaItem of tallas; track tallaItem) {
                  <mat-option [value]="tallaItem">{{ tallaItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('tallaCamisa')) {
                <mat-error>{{ getErrorMessage('tallaCamisa') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Calzado</mat-label>
                <mat-select formControlName="tallaCalzado">
                  @for (tallaItem of tallasCalzado; track tallaItem) {
                  <mat-option [value]="tallaItem">{{ tallaItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('tallaCalzado')) {
                <mat-error>{{ getErrorMessage('tallaCalzado') }}</mat-error>
                }
              </mat-form-field>
            </div>

            <div
              style="display:flex; gap:10px; justify-content:space-between; margin-top:12px;">
              <button type="button" matButton="outlined"
                matStepperPrevious>Anterior</button>
              <button type="button" matButton="filled"
                matStepperNext>Siguiente</button>
            </div>
          </mat-step>

          <!-- ========================================================= -->
          <!-- STEP 3: FAMILIA Y REFERENCIAS -->
          <!-- ========================================================= -->
          <mat-step>
            <ng-template matStepLabel>Familia y referencias</ng-template>

            <div class="title">
              <h1>Familia y referencias</h1>
              <p style="margin:4px 0 0 0; font-size:12px; color:#6b7280;">
                Información familiar y contactos de referencia.
              </p>
            </div>

            @if (estadoCivilVal && estadoCivilVal !== 'SO') {
            <h2
              style="margin: 10px 0 6px 0; font-size: 14px; font-weight: 800; color:#111827;">
              Cónyuge
            </h2>

            <div class="datos">
              <mat-form-field appearance="outline">
                <mat-label>Nombres</mat-label>
                <input matInput formControlName="nombresConyuge" />
                @if (shouldShowError('nombresConyuge')) {
                <mat-error>{{ getErrorMessage('nombresConyuge') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Apellidos</mat-label>
                <input matInput formControlName="apellidosConyuge" />
                @if (shouldShowError('apellidosConyuge')) {
                <mat-error>{{ getErrorMessage('apellidosConyuge') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>¿Vive?</mat-label>
                <mat-select formControlName="viveConyuge">
                  @for (opcionItem of opcionBinaria; track opcionItem.value) {
                  <mat-option [value]="opcionItem.value">{{ opcionItem.display
                    }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('viveConyuge')) {
                <mat-error>{{ getErrorMessage('viveConyuge') }}</mat-error>
                }
              </mat-form-field>

              @if (viveConyugeVal === 'SI') {
              <mat-form-field appearance="outline">
                <mat-label>No. documento</mat-label>
                <input matInput formControlName="documentoIdentidadConyuge"
                  type="text" />
                @if (shouldShowError('documentoIdentidadConyuge')) {
                <mat-error>{{ getErrorMessage('documentoIdentidadConyuge')
                  }}</mat-error>
                }
              </mat-form-field>

              <!--direccionConyuge-->
              <mat-form-field appearance="outline">
                <mat-label>Dirección</mat-label>
                <input matInput formControlName="direccionConyuge" />
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Teléfono</mat-label>
                <input matInput formControlName="telefonoConyuge" type="tel" />
                @if (shouldShowError('telefonoConyuge')) {
                <mat-error>{{ getErrorMessage('telefonoConyuge') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Barrio / municipio</mat-label>
                <input matInput formControlName="barrioConyuge" />
                @if (shouldShowError('barrioConyuge')) {
                <mat-error>{{ getErrorMessage('barrioConyuge') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Ocupación</mat-label>
                <input matInput formControlName="ocupacionConyuge" />
                @if (shouldShowError('ocupacionConyuge')) {
                <mat-error>{{ getErrorMessage('ocupacionConyuge') }}</mat-error>
                }
              </mat-form-field>
              }
            </div>
            }

            <h2
              style="margin: 16px 0 6px 0; font-size: 14px; font-weight: 800; color:#111827;">
              Padres
            </h2>

            <h3
              style="margin: 8px 0 6px 0; font-size: 13px; font-weight: 800; color:#111827;">
              Padre
            </h3>

            <div class="datos">
              <mat-form-field appearance="outline">
                <mat-label>Nombre</mat-label>
                <input matInput formControlName="nombrePadre"
                  placeholder="Nombre y apellido" />
                @if (shouldShowError('nombrePadre')) {
                <mat-error>{{ getErrorMessage('nombrePadre') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>¿Vive?</mat-label>
                <mat-select formControlName="elPadreVive">
                  @for (opcionItem of opcionBinaria; track opcionItem.value) {
                  <mat-option [value]="opcionItem.value">{{ opcionItem.display
                    }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('elPadreVive')) {
                <mat-error>{{ getErrorMessage('elPadreVive') }}</mat-error>
                }
              </mat-form-field>

              @if (elPadreViveVal === 'SI') {
              <mat-form-field appearance="outline">
                <mat-label>Ocupación</mat-label>
                <input matInput formControlName="ocupacionPadre" />
                @if (shouldShowError('ocupacionPadre')) {
                <mat-error>{{ getErrorMessage('ocupacionPadre') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Dirección</mat-label>
                <input matInput formControlName="direccionPadre" />
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Teléfono</mat-label>
                <input matInput formControlName="telefonoPadre" type="tel" />
                @if (shouldShowError('telefonoPadre')) {
                <mat-error>{{ getErrorMessage('telefonoPadre') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Barrio / municipio</mat-label>
                <input matInput formControlName="barrioPadre" />
                @if (shouldShowError('barrioPadre')) {
                <mat-error>{{ getErrorMessage('barrioPadre') }}</mat-error>
                }
              </mat-form-field>
              }
            </div>

            <h3
              style="margin: 8px 0 6px 0; font-size: 13px; font-weight: 800; color:#111827;">
              Madre
            </h3>

            <div class="datos">
              <mat-form-field appearance="outline">
                <mat-label>Nombre</mat-label>
                <input matInput formControlName="nombreMadre"
                  placeholder="Nombre y apellido" />
                @if (shouldShowError('nombreMadre')) {
                <mat-error>{{ getErrorMessage('nombreMadre') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>¿Vive?</mat-label>
                <mat-select formControlName="madreVive">
                  @for (opcionItem of opcionBinaria; track opcionItem.value) {
                  <mat-option [value]="opcionItem.value">{{ opcionItem.display
                    }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('madreVive')) {
                <mat-error>{{ getErrorMessage('madreVive') }}</mat-error>
                }
              </mat-form-field>

              @if (madreViveVal === 'SI') {
              <mat-form-field appearance="outline">
                <mat-label>Ocupación</mat-label>
                <input matInput formControlName="ocupacionMadre" />
                @if (shouldShowError('ocupacionMadre')) {
                <mat-error>{{ getErrorMessage('ocupacionMadre') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Dirección</mat-label>
                <input matInput formControlName="direccionMadre" />
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Teléfono</mat-label>
                <input matInput formControlName="telefonoMadre" type="tel" />
                @if (shouldShowError('telefonoMadre')) {
                <mat-error>{{ getErrorMessage('telefonoMadre') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Barrio / municipio</mat-label>
                <input matInput formControlName="barrioMadre" />
                @if (shouldShowError('barrioMadre')) {
                <mat-error>{{ getErrorMessage('barrioMadre') }}</mat-error>
                }
              </mat-form-field>
              }
            </div>

            <!-- Referencias -->
            <div class="datos refs">
              <div class="section-head">
                <h2 class="section-title">Referencias</h2>
                <p class="section-subtitle">Personales y familiares</p>
              </div>

              <div class="refs-wrap">
                <!-- Personal 1 -->
                <section class="ref-box">
                  <header class="ref-box__header">
                    <span class="ref-badge ref-badge--personal">Personal
                      1</span>
                    <span class="ref-box__subtitle">Referencia personal</span>
                  </header>

                  <div class="ref-grid">
                    <mat-form-field appearance="outline">
                      <mat-label>Nombre</mat-label>
                      <input matInput
                        formControlName="nombreReferenciaPersonal1"
                        placeholder="Nombre y apellido" />
                      @if (shouldShowError('nombreReferenciaPersonal1')) {
                      <mat-error>{{ getErrorMessage('nombreReferenciaPersonal1')
                        }}</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Teléfono</mat-label>
                      <input matInput formControlName="telefonoReferencia1"
                        type="tel" />
                      @if (shouldShowError('telefonoReferencia1')) {
                      <mat-error>{{ getErrorMessage('telefonoReferencia1')
                        }}</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Ocupación</mat-label>
                      <input matInput formControlName="ocupacionReferencia1" />
                      @if (shouldShowError('ocupacionReferencia1')) {
                      <mat-error>{{ getErrorMessage('ocupacionReferencia1')
                        }}</mat-error>
                      }
                    </mat-form-field>

                    <!--direccionReferenciaPersonal1-->
                    <mat-form-field appearance="outline">
                      <mat-label>Dirección</mat-label>
                      <input matInput formControlName="direccionReferenciaPersonal1" />
                      @if (shouldShowError('direccionReferenciaPersonal1')) {
                      <mat-error>{{ getErrorMessage('direccionReferenciaPersonal1') }}</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Tiempo de conocimiento</mat-label>
                      <mat-select
                        formControlName="tiempoConoceReferenciaPersonal1">
                        @for (tiempoItem of listaDuracion; track tiempoItem) {
                        <mat-option [value]="tiempoItem">{{ tiempoItem
                          }}</mat-option>
                        }
                      </mat-select>
                      @if (shouldShowError('tiempoConoceReferenciaPersonal1')) {
                      <mat-error>{{
                        getErrorMessage('tiempoConoceReferenciaPersonal1')
                        }}</mat-error>
                      }
                    </mat-form-field>
                  </div>
                </section>

                <!-- Personal 2 -->
                <section class="ref-box">
                  <header class="ref-box__header">
                    <span class="ref-badge ref-badge--personal">Personal
                      2</span>
                    <span class="ref-box__subtitle">Referencia personal</span>
                  </header>

                  <div class="ref-grid">
                    <mat-form-field appearance="outline">
                      <mat-label>Nombre</mat-label>
                      <input matInput
                        formControlName="nombreReferenciaPersonal2"
                        placeholder="Nombre y apellido" />
                      @if (shouldShowError('nombreReferenciaPersonal2')) {
                      <mat-error>{{ getErrorMessage('nombreReferenciaPersonal2')
                        }}</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Teléfono</mat-label>
                      <input matInput formControlName="telefonoReferencia2"
                        type="tel" />
                      @if (shouldShowError('telefonoReferencia2')) {
                      <mat-error>{{ getErrorMessage('telefonoReferencia2')
                        }}</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Ocupación</mat-label>
                      <input matInput formControlName="ocupacionReferencia2" />
                      @if (shouldShowError('ocupacionReferencia2')) {
                      <mat-error>{{ getErrorMessage('ocupacionReferencia2')
                        }}</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Dirección</mat-label>
                      <input matInput formControlName="direccionReferenciaPersonal2" />
                      @if (shouldShowError('direccionReferenciaPersonal2')) {
                      <mat-error>{{ getErrorMessage('direccionReferenciaPersonal2') }}</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Tiempo de conocimiento</mat-label>
                      <mat-select
                        formControlName="tiempoConoceReferenciaPersonal2">
                        @for (tiempoItem of listaDuracion; track tiempoItem) {
                        <mat-option [value]="tiempoItem">{{ tiempoItem
                          }}</mat-option>
                        }
                      </mat-select>
                      @if (shouldShowError('tiempoConoceReferenciaPersonal2')) {
                      <mat-error>{{
                        getErrorMessage('tiempoConoceReferenciaPersonal2')
                        }}</mat-error>
                      }
                    </mat-form-field>
                  </div>
                </section>

                <!-- Familiar 1 -->
                <section class="ref-box">
                  <header class="ref-box__header">
                    <span class="ref-badge ref-badge--familiar">Familiar
                      1</span>
                    <span class="ref-box__subtitle">Referencia familiar</span>
                  </header>

                  <div class="ref-grid">
                    <mat-form-field appearance="outline">
                      <mat-label>Nombre</mat-label>
                      <input matInput
                        formControlName="nombreReferenciaFamiliar1"
                        placeholder="Nombre y apellido" />
                      @if (shouldShowError('nombreReferenciaFamiliar1')) {
                      <mat-error>{{ getErrorMessage('nombreReferenciaFamiliar1')
                        }}</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Teléfono</mat-label>
                      <input matInput
                        formControlName="telefonoReferenciaFamiliar1"
                        type="tel" />
                      @if (shouldShowError('telefonoReferenciaFamiliar1')) {
                      <mat-error>{{
                        getErrorMessage('telefonoReferenciaFamiliar1')
                        }}</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Ocupación</mat-label>
                      <input matInput
                        formControlName="ocupacionReferenciaFamiliar1" />
                      @if (shouldShowError('ocupacionReferenciaFamiliar1')) {
                      <mat-error>{{
                        getErrorMessage('ocupacionReferenciaFamiliar1')
                        }}</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Dirección</mat-label>
                      <input matInput formControlName="direccionReferenciaFamiliar1" />
                      @if (shouldShowError('direccionReferenciaFamiliar1')) {
                      <mat-error>{{ getErrorMessage('direccionReferenciaFamiliar1') }}</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Parentesco</mat-label>
                      <mat-select
                        formControlName="parentescoReferenciaFamiliar1">
                        @for (parentescoItem of listaParentescosFamiliares;
                        track parentescoItem) {
                        <mat-option [value]="parentescoItem">{{ parentescoItem
                          }}</mat-option>
                        }
                      </mat-select>
                      @if (shouldShowError('parentescoReferenciaFamiliar1')) {
                      <mat-error>{{
                        getErrorMessage('parentescoReferenciaFamiliar1')
                        }}</mat-error>
                      }
                    </mat-form-field>
                  </div>
                </section>

                <!-- Familiar 2 -->
                <section class="ref-box">
                  <header class="ref-box__header">
                    <span class="ref-badge ref-badge--familiar">Familiar
                      2</span>
                    <span class="ref-box__subtitle">Referencia familiar</span>
                  </header>

                  <div class="ref-grid">
                    <mat-form-field appearance="outline">
                      <mat-label>Nombre</mat-label>
                      <input matInput
                        formControlName="nombreReferenciaFamiliar2"
                        placeholder="Nombre y apellido" />
                      @if (shouldShowError('nombreReferenciaFamiliar2')) {
                      <mat-error>{{ getErrorMessage('nombreReferenciaFamiliar2')
                        }}</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Teléfono</mat-label>
                      <input matInput
                        formControlName="telefonoReferenciaFamiliar2"
                        type="tel" />
                      @if (shouldShowError('telefonoReferenciaFamiliar2')) {
                      <mat-error>{{
                        getErrorMessage('telefonoReferenciaFamiliar2')
                        }}</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Ocupación</mat-label>
                      <input matInput
                        formControlName="ocupacionReferenciaFamiliar2" />
                      @if (shouldShowError('ocupacionReferenciaFamiliar2')) {
                      <mat-error>{{
                        getErrorMessage('ocupacionReferenciaFamiliar2')
                        }}</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Dirección</mat-label>
                      <input matInput formControlName="direccionReferenciaFamiliar2" />
                      @if (shouldShowError('direccionReferenciaFamiliar2')) {
                      <mat-error>{{ getErrorMessage('direccionReferenciaFamiliar2') }}</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Parentesco</mat-label>
                      <mat-select
                        formControlName="parentescoReferenciaFamiliar2">
                        @for (parentescoItem of listaParentescosFamiliares;
                        track parentescoItem) {
                        <mat-option [value]="parentescoItem">{{ parentescoItem
                          }}</mat-option>
                        }
                      </mat-select>
                      @if (shouldShowError('parentescoReferenciaFamiliar2')) {
                      <mat-error>{{
                        getErrorMessage('parentescoReferenciaFamiliar2')
                        }}</mat-error>
                      }
                    </mat-form-field>
                  </div>
                </section>
              </div>
            </div>

            <div
              style="display:flex; gap:10px; justify-content:space-between; margin-top:12px;">
              <button type="button" matButton="outlined"
                matStepperPrevious>Anterior</button>
              <button type="button" matButton="filled"
                matStepperNext>Siguiente</button>
            </div>
          </mat-step>

          <!-- ========================================================= -->
          <!-- STEP 4: EXPERIENCIA, HIJOS Y VIVIENDA -->
          <!-- ========================================================= -->
          <mat-step>
            <ng-template matStepLabel>Experiencia y vivienda</ng-template>

            <div class="title">
              <h1>Experiencia y vivienda</h1>
              <p style="margin:4px 0 0 0; font-size:12px; color:#6b7280;">
                Experiencia laboral, hijos, convivencia y vivienda.
              </p>
            </div>

            <h2
              style="margin: 10px 0 6px 0; font-size: 14px; font-weight: 800; color:#111827;">
              Experiencia laboral
            </h2>

            <div class="datos">
              <mat-form-field appearance="outline">
                <mat-label>¿Tiene experiencia laboral?</mat-label>
                <mat-select formControlName="experienciaLaboral">
                  @for (opcionItem of opcionBinaria; track opcionItem.value) {
                  <mat-option [value]="opcionItem.value">{{ opcionItem.display
                    }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('experienciaLaboral')) {
                <mat-error>{{ getErrorMessage('experienciaLaboral')
                  }}</mat-error>
                }
              </mat-form-field>

              @if (experienciaVal === 'SI') {
              <mat-form-field appearance="outline">
                <mat-label>Empresa</mat-label>
                <input matInput formControlName="nombreEmpresa1" />
                @if (shouldShowError('nombreEmpresa1')) {
                <mat-error>{{ getErrorMessage('nombreEmpresa1') }}</mat-error>
                }
              </mat-form-field>


              <mat-form-field appearance="outline">
                <mat-label>Teléfonos</mat-label>
                <input matInput formControlName="telefonosEmpresa1"
                  type="tel" />
                @if (shouldShowError('telefonosEmpresa1')) {
                <mat-error>{{ getErrorMessage('telefonosEmpresa1')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Jefe inmediato</mat-label>
                <input matInput formControlName="nombreJefe1" />
                @if (shouldShowError('nombreJefe1')) {
                <mat-error>{{ getErrorMessage('nombreJefe1') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Cargo</mat-label>
                <input matInput formControlName="cargoEmpresa1" />
                @if (shouldShowError('cargoEmpresa1')) {
                <mat-error>{{ getErrorMessage('cargoEmpresa1') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Áreas de experiencia</mat-label>
                <mat-select formControlName="areaExperiencia" multiple>
                  @for (areaItem of areasExperiencia; track areaItem) {
                  <mat-option [value]="areaItem">{{ areaItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('areaExperiencia')) {
                <mat-error>{{ getErrorMessage('areaExperiencia') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Fecha de retiro</mat-label>
                <input
                  matInput
                  [matDatepicker]="pickerRetiro1"
                  formControlName="fechaRetiro1"
                  (focus)="pickerRetiro1.open()" />
                <mat-datepicker-toggle matSuffix
                  [for]="pickerRetiro1"></mat-datepicker-toggle>
                <mat-datepicker #pickerRetiro1></mat-datepicker>

                @if (shouldShowError('fechaRetiro1')) {
                <mat-error>{{ getErrorMessage('fechaRetiro1') }}</mat-error>
                }
                @if (
                formHojaDeVida2.get('fechaRetiro1')?.hasError('matDatepickerParse')
                &&
                (formHojaDeVida2.get('fechaRetiro1')?.touched ||
                formHojaDeVida2.get('fechaRetiro1')?.dirty)
                ) {
                <mat-error>Fecha inválida.</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Tiempo de experiencia</mat-label>
                <mat-select formControlName="tiempoExperiencia">
                  @for (tiempoItem of tiempoTrabajado; track tiempoItem) {
                  <mat-option [value]="tiempoItem">{{ tiempoItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('tiempoExperiencia')) {
                <mat-error>{{ getErrorMessage('tiempoExperiencia')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Motivo de retiro</mat-label>
                <input matInput formControlName="motivoRetiro1" />
                @if (shouldShowError('motivoRetiro1')) {
                <mat-error>{{ getErrorMessage('motivoRetiro1') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Empresas donde ha laborado</mat-label>
                <input matInput formControlName="empresas_laborado"
                  placeholder="Separar con ," />
                @if (shouldShowError('empresas_laborado')) {
                <mat-error>{{ getErrorMessage('empresas_laborado')
                  }}</mat-error>
                }
              </mat-form-field>
              }
            </div>

            <!-- Hijos -->
            <section class="datos kids">
              <div class="section-head">
                <h2 class="section-title">Hijos</h2>
                <p class="section-subtitle">Dependientes, edades y datos</p>
              </div>

              <div class="kids-controls">
                <mat-form-field appearance="outline">
                  <mat-label>Número de hijos dependientes</mat-label>
                  <input matInput type="number"
                    formControlName="numHijosDependientes" min="0" />
                  @if (shouldShowError('numHijosDependientes')) {
                  <mat-error>{{ getErrorMessage('numHijosDependientes')
                    }}</mat-error>
                  }
                </mat-form-field>

                @if (numHijos > 0) {
                <mat-form-field appearance="outline">
                  <mat-label>¿Quién cuida a los hijos?</mat-label>
                  <mat-select formControlName="cuidadorHijos">
                    @for (cuidadorItem of listaPersonasQueCuidan; track
                    cuidadorItem) {
                    <mat-option [value]="cuidadorItem">{{ cuidadorItem
                      }}</mat-option>
                    }
                  </mat-select>
                  @if (shouldShowError('cuidadorHijos')) {
                  <mat-error>{{ getErrorMessage('cuidadorHijos') }}</mat-error>
                  }
                </mat-form-field>
                }
              </div>

              @if (numHijos > 0 && numHijos <= 5) {
              <div class="kids-ages">
                @for (controlName of generarArrayHijos(); track $index) {
                <mat-form-field appearance="outline">
                  <mat-label>Edad del hijo {{ $index + 1 }}</mat-label>
                  <input matInput type="number"
                    [formControlName]="'edadHijo' + ($index + 1)" min="0" />
                  @if (shouldShowError('edadHijo' + ($index + 1))) {
                  <mat-error>{{ getErrorMessage('edadHijo' + ($index + 1))
                    }}</mat-error>
                  }
                </mat-form-field>
                }
              </div>

              <div formArrayName="hijos" class="kids-wrap">
                @for (hijo of hijosFormArray.controls; track $index) {
                <section [formGroupName]="$index" class="kid-box">
                  <header class="kid-box__header">
                    <span class="kid-badge">Hijo {{ $index + 1 }}</span>
                    <span class="kid-box__subtitle">Datos del hijo</span>
                  </header>

                  <div class="kid-grid">
                    <mat-form-field appearance="outline">
                      <mat-label>Nombre</mat-label>
                      <input matInput formControlName="nombreHijo"
                        placeholder="Nombre del hijo" />
                      @if (hijo.get('nombreHijo')?.invalid &&
                      (hijo.get('nombreHijo')?.touched ||
                      hijo.get('nombreHijo')?.dirty)) {
                      <mat-error>Escribe el nombre del hijo.</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Sexo</mat-label>
                      <mat-select formControlName="sexoHijo">
                        <mat-option [value]="'M'">M</mat-option>
                        <mat-option [value]="'F'">F</mat-option>
                      </mat-select>
                      @if (hijo.get('sexoHijo')?.invalid &&
                      (hijo.get('sexoHijo')?.touched ||
                      hijo.get('sexoHijo')?.dirty)) {
                      <mat-error>Selecciona el sexo del hijo.</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Fecha de nacimiento</mat-label>
                      <input
                        matInput
                        [matDatepicker]="pickerFechaNacimientoHijo"
                        formControlName="fechaNacimientoHijo"
                        (focus)="pickerFechaNacimientoHijo.open()" />
                      <mat-datepicker-toggle matSuffix
                        [for]="pickerFechaNacimientoHijo"></mat-datepicker-toggle>
                      <mat-datepicker
                        #pickerFechaNacimientoHijo></mat-datepicker>

                      @if (hijo.get('fechaNacimientoHijo')?.hasError('required')
                      && (hijo.get('fechaNacimientoHijo')?.touched ||
                      hijo.get('fechaNacimientoHijo')?.dirty)) {
                      <mat-error>La fecha de nacimiento es
                        obligatoria.</mat-error>
                      }
                      @if
                      (hijo.get('fechaNacimientoHijo')?.hasError('matDatepickerParse')
                      && (hijo.get('fechaNacimientoHijo')?.touched ||
                      hijo.get('fechaNacimientoHijo')?.dirty)) {
                      <mat-error>Fecha inválida.</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Documento</mat-label>
                      <input matInput formControlName="docIdentidadHijo" />
                      @if (hijo.get('docIdentidadHijo')?.invalid &&
                      (hijo.get('docIdentidadHijo')?.touched ||
                      hijo.get('docIdentidadHijo')?.dirty)) {
                      <mat-error>Completa el documento del hijo.</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Ocupación</mat-label>
                      <input matInput formControlName="ocupacionHijo" />
                      @if (hijo.get('ocupacionHijo')?.invalid &&
                      (hijo.get('ocupacionHijo')?.touched ||
                      hijo.get('ocupacionHijo')?.dirty)) {
                      <mat-error>Completa la ocupación del hijo.</mat-error>
                      }
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Curso</mat-label>
                      <input matInput formControlName="cursoHijo" />
                      @if (hijo.get('cursoHijo')?.invalid &&
                      (hijo.get('cursoHijo')?.touched ||
                      hijo.get('cursoHijo')?.dirty)) {
                      <mat-error>Completa el curso del hijo.</mat-error>
                      }
                    </mat-form-field>
                  </div>
                </section>
                }
              </div>
              }
            </section>

            <!-- Convivencia -->
            <h2
              style="margin: 16px 0 6px 0; font-size: 14px; font-weight: 800; color:#111827;">
              Convivencia
            </h2>

            <div class="datos">
              <mat-form-field appearance="outline">
                <mat-label>¿Con quién vive?</mat-label>
                <mat-select formControlName="conQuienViveChecks" multiple>
                  @for (opcionItem of listaPosiblesRespuestasConquienVive; track
                  opcionItem) {
                  <mat-option [value]="opcionItem">{{ opcionItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('conQuienViveChecks')) {
                <mat-error>{{ getErrorMessage('conQuienViveChecks')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>¿Familia con un solo ingreso?</mat-label>
                <mat-select formControlName="familiaSolo">
                  @for (opcionItem of opcionBinaria; track opcionItem.value) {
                  <mat-option [value]="opcionItem.value">{{ opcionItem.display
                    }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('familiaSolo')) {
                <mat-error>{{ getErrorMessage('familiaSolo') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Personas a cargo</mat-label>
                <mat-select formControlName="personas_a_cargo" multiple>
                  @for (personaItem of personasACargoOptions; track personaItem)
                  {
                  <mat-option [value]="personaItem">{{ personaItem
                    }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('personas_a_cargo')) {
                <mat-error>{{ getErrorMessage('personas_a_cargo') }}</mat-error>
                }
              </mat-form-field>
            </div>

            <!-- Vivienda -->
            <h2
              style="margin: 16px 0 6px 0; font-size: 14px; font-weight: 800; color:#111827;">
              Vivienda
            </h2>

            <div class="datos">
              <mat-form-field appearance="outline">
                <mat-label>Tipo de vivienda (opciones)</mat-label>
                <mat-select formControlName="tiposViviendaChecks" multiple>
                  @for (tipoItem of tiposVivienda; track tipoItem) {
                  <mat-option [value]="tipoItem">{{ tipoItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('tiposViviendaChecks')) {
                <mat-error>{{ getErrorMessage('tiposViviendaChecks')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Número de habitaciones</mat-label>
                <mat-select formControlName="numeroHabitaciones">
                  @for (numeroItem of [1, 2, 3, 4, 5, 6, 7, 8]; track
                  numeroItem) {
                  <mat-option [value]="numeroItem">{{ numeroItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('numeroHabitaciones')) {
                <mat-error>{{ getErrorMessage('numeroHabitaciones')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Personas por habitación</mat-label>
                <mat-select formControlName="personasPorHabitacion">
                  @for (numeroItem of [1, 2, 3, 4, 5, 6, 7, 8]; track
                  numeroItem) {
                  <mat-option [value]="numeroItem">{{ numeroItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('personasPorHabitacion')) {
                <mat-error>{{ getErrorMessage('personasPorHabitacion')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Características</mat-label>
                <mat-select formControlName="caracteristicasVivienda">
                  @for (caracteristicaItem of caracteristicasVivienda; track
                  caracteristicaItem) {
                  <mat-option [value]="caracteristicaItem">{{ caracteristicaItem
                    }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('caracteristicasVivienda')) {
                <mat-error>{{ getErrorMessage('caracteristicasVivienda')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Servicios / comodidades</mat-label>
                <mat-select formControlName="comodidadesChecks" multiple>
                  @for (comodidadItem of comodidades; track comodidadItem) {
                  <mat-option [value]="comodidadItem">{{ comodidadItem
                    }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('comodidadesChecks')) {
                <mat-error>{{ getErrorMessage('comodidadesChecks')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Expectativas de vida</mat-label>
                <mat-select formControlName="expectativasVidaChecks" multiple>
                  @for (expectativaItem of expectativasVida; track
                  expectativaItem) {
                  <mat-option [value]="expectativaItem">{{ expectativaItem
                    }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('expectativasVidaChecks')) {
                <mat-error>{{ getErrorMessage('expectativasVidaChecks')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>¿Cómo se enteró de la vacante?</mat-label>
                <mat-select formControlName="fuenteVacante">
                  @for (fuenteItem of opcionesPromocion; track fuenteItem) {
                  <mat-option [value]="fuenteItem">{{ fuenteItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('fuenteVacante')) {
                <mat-error>{{ getErrorMessage('fuenteVacante') }}</mat-error>
                }
              </mat-form-field>
            </div>

            <div
              style="display:flex; gap:10px; justify-content:space-between; margin-top:12px;">
              <button type="button" matButton="outlined"
                matStepperPrevious>Anterior</button>
              <button type="button" matButton="filled"
                matStepperNext>Siguiente</button>
            </div>
          </mat-step>

          <!-- ========================================================= -->
          <!-- STEP 5: ADJUNTOS Y DATOS FINALES -->
          <!-- ========================================================= -->
          <mat-step>
            <ng-template matStepLabel>Adjuntos y final</ng-template>

            <div class="title">
              <h1>Adjuntos y datos finales</h1>
              <p style="margin:4px 0 0 0; font-size:12px; color:#6b7280;">
                Carga de hoja de vida y datos adicionales.
              </p>
            </div>

            <h2
              style="margin: 10px 0 6px 0; font-size: 14px; font-weight: 800; color:#111827;">
              Hoja de vida
            </h2>

            <div class="datos">
              <mat-form-field appearance="outline">
                <mat-label>¿Desea generar su hoja de vida?</mat-label>
                <mat-select formControlName="deseaGenerar"
                  (selectionChange)="onSelectionChange()">
                  <mat-option [value]="true">Sí</mat-option>
                  <mat-option [value]="false">No</mat-option>
                </mat-select>
                @if (shouldShowError('deseaGenerar')) {
                <mat-error>{{ getErrorMessage('deseaGenerar') }}</mat-error>
                }
              </mat-form-field>

              @if (deseaGenerarVal === false) {
              <div class="input-container" style="grid-column: 1 / -1;">
                <button
                  mat-icon-button
                  [matMenuTriggerFor]="pdfMenuHojaDeVida"
                  aria-label="PDF options"
                  type="button">
                  <mat-icon>more_vert</mat-icon>
                </button>

                <mat-menu #pdfMenuHojaDeVida="matMenu">
                  <button mat-menu-item (click)="verArchivo('hojaDeVida')"
                    type="button">Ver PDF</button>

                  <button mat-menu-item type="button">
                    <label for="fileInputHojaDeVida"
                      style="cursor:pointer;">Subir PDF</label>
                  </button>

                  <input
                    type="file"
                    id="fileInputHojaDeVida"
                    style="display:none;"
                    (change)="subirArchivo($event, 'hojaDeVida')"
                    accept=".pdf" />
                </mat-menu>

                <mat-form-field appearance="outline" class="example-full-width">
                  <mat-label>Archivo cargado</mat-label>
                  <input matInput formControlName="hojaDeVida" readonly />

                  @if (uploadedFiles?.['hojaDeVida']?.fileName) {
                  <mat-hint align="start">{{
                    uploadedFiles['hojaDeVida'].fileName }}</mat-hint>
                  }

                  @if (shouldShowError('hojaDeVida')) {
                  <mat-error>{{ getErrorMessage('hojaDeVida') }}</mat-error>
                  }
                </mat-form-field>
              </div>
              }
            </div>

            @if (deseaGenerarVal === true) {
            <h2
              style="margin: 16px 0 6px 0; font-size: 14px; font-weight: 800; color:#111827;">
              Información adicional
            </h2>

            <div class="datos">
              <mat-form-field appearance="outline">
                <mat-label>¿Tiene vehículo?</mat-label>
                <mat-select formControlName="tieneVehiculo">
                  <mat-option value="SI">Sí</mat-option>
                  <mat-option value="NO">No</mat-option>
                </mat-select>
                @if (shouldShowError('tieneVehiculo')) {
                <mat-error>{{ getErrorMessage('tieneVehiculo') }}</mat-error>
                }
              </mat-form-field>

              @if (tieneVehiculoVal === 'SI') {
              <mat-form-field appearance="outline">
                <mat-label>Licencia de conducción</mat-label>
                <input matInput formControlName="licenciaConduccion" />
                @if (shouldShowError('licenciaConduccion')) {
                <mat-error>{{ getErrorMessage('licenciaConduccion')
                  }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Categorías</mat-label>
                <mat-select formControlName="categoriaLicencia" multiple>
                  @for (categoriaItem of categoriasLicencia; track
                  categoriaItem) {
                  <mat-option [value]="categoriaItem">{{ categoriaItem
                    }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('categoriaLicencia')) {
                <mat-error>{{ getErrorMessage('categoriaLicencia')
                  }}</mat-error>
                }
              </mat-form-field>
              }

              <mat-form-field appearance="outline">
                <mat-label>¿Está trabajando actualmente?</mat-label>
                <mat-select formControlName="estaTrabajando">
                  <mat-option value="SI">Sí</mat-option>
                  <mat-option value="NO">No</mat-option>
                </mat-select>
                @if (shouldShowError('estaTrabajando')) {
                <mat-error>{{ getErrorMessage('estaTrabajando') }}</mat-error>
                }
              </mat-form-field>

              @if (estaTrabajandoVal === 'SI') {
              <mat-form-field appearance="outline">
                <mat-label>Empresa actual</mat-label>
                <input matInput formControlName="empresaActual" />
                @if (shouldShowError('empresaActual')) {
                <mat-error>{{ getErrorMessage('empresaActual') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Tipo de trabajo</mat-label>
                <mat-select formControlName="tipoTrabajo">
                  <mat-option value="Empleado">Empleado</mat-option>
                  <mat-option value="Independiente">Independiente</mat-option>
                </mat-select>
                @if (shouldShowError('tipoTrabajo')) {
                <mat-error>{{ getErrorMessage('tipoTrabajo') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Tipo de contrato</mat-label>
                <mat-select formControlName="tipoContrato">
                  @for (tipoItem of tiposContrato; track tipoItem) {
                  <mat-option [value]="tipoItem">{{ tipoItem }}</mat-option>
                  }
                </mat-select>
                @if (shouldShowError('tipoContrato')) {
                <mat-error>{{ getErrorMessage('tipoContrato') }}</mat-error>
                }
              </mat-form-field>
              }

              <mat-form-field appearance="outline">
                <mat-label>¿Trabajó antes en la empresa?</mat-label>
                <mat-select formControlName="trabajoAntes">
                  <mat-option value="SI">Sí</mat-option>
                  <mat-option value="NO">No</mat-option>
                </mat-select>
                @if (shouldShowError('trabajoAntes')) {
                <mat-error>{{ getErrorMessage('trabajoAntes') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>¿Solicitó empleo antes?</mat-label>
                <mat-select formControlName="solicitoAntes">
                  <mat-option value="SI">Sí</mat-option>
                  <mat-option value="NO">No</mat-option>
                </mat-select>
                @if (shouldShowError('solicitoAntes')) {
                <mat-error>{{ getErrorMessage('solicitoAntes') }}</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>¿Tiene hermanos?</mat-label>
                <mat-select formControlName="tieneHermanos">
                  <mat-option [value]="'SI'">Sí</mat-option>
                  <mat-option [value]="'NO'">No</mat-option>
                </mat-select>
                @if (shouldShowError('tieneHermanos')) {
                <mat-error>{{ getErrorMessage('tieneHermanos') }}</mat-error>
                }
              </mat-form-field>

              @if (tieneHermanosVal === 'SI') {
              <mat-form-field appearance="outline">
                <mat-label>Número de hermanos</mat-label>
                <mat-select formControlName="numeroHermanos">
                  <mat-option [value]="1">1</mat-option>
                  <mat-option [value]="2">2</mat-option>
                </mat-select>
                @if (shouldShowError('numeroHermanos')) {
                <mat-error>{{ getErrorMessage('numeroHermanos') }}</mat-error>
                }
              </mat-form-field>
              }
            </div>

            @if (tieneHermanosVal === 'SI' && hermanosArray?.length &&
            hermanosArray.length > 0) {
            <h3
              style="margin: 10px 0 6px 0; font-size: 13px; font-weight: 800; color:#111827;">
              Detalle de hermanos
            </h3>

            <div formArrayName="hermanos" style="grid-column: 1 / -1;">
              @for (hermano of hermanosArray.controls; track $index) {
              <div [formGroupName]="$index" class="hermano-container">
                <h4
                  style="margin: 10px 0 6px 0; font-size: 13px; font-weight: 800; color:#111827;">
                  Hermano {{ $index + 1 }}
                </h4>

                <div class="datos">
                  <mat-form-field appearance="outline">
                    <mat-label>Nombre</mat-label>
                    <input matInput formControlName="nombre" />
                    @if (hermano.get('nombre')?.invalid &&
                    (hermano.get('nombre')?.touched ||
                    hermano.get('nombre')?.dirty)) {
                    <mat-error>Escribe el nombre del hermano.</mat-error>
                    }
                  </mat-form-field>

                  <mat-form-field appearance="outline">
                    <mat-label>Profesión / oficio</mat-label>
                    <input matInput formControlName="profesion" />
                    @if (hermano.get('profesion')?.invalid &&
                    (hermano.get('profesion')?.touched ||
                    hermano.get('profesion')?.dirty)) {
                    <mat-error>Escribe la profesión u oficio.</mat-error>
                    }
                  </mat-form-field>

                  <mat-form-field appearance="outline">
                    <mat-label>Teléfono</mat-label>
                    <input matInput formControlName="telefono" />
                    @if (hermano.get('telefono')?.errors?.['required'] &&
                    (hermano.get('telefono')?.touched ||
                    hermano.get('telefono')?.dirty)) {
                    <mat-error>El teléfono es obligatorio.</mat-error>
                    }
                    @if ((hermano.get('telefono')?.errors?.['pattern'] ||
                    hermano.get('telefono')?.errors?.['phoneCO']) &&
                    (hermano.get('telefono')?.touched ||
                    hermano.get('telefono')?.dirty)) {
                    <mat-error>Número inválido. Revisa el teléfono.</mat-error>
                    }
                  </mat-form-field>
                </div>
              </div>
              }
            </div>
            }
            }

            <div
              style="display:flex; gap:10px; justify-content:space-between; margin-top:12px;">
              <button type="button" matButton="outlined"
                matStepperPrevious>Anterior</button>
              <button type="submit" matButton="filled" style="min-width:220px;">
                Guardar
              </button>
            </div>
          </mat-step>

        </mat-horizontal-stepper>
      </div>
    </form>
  </div>
</div>
