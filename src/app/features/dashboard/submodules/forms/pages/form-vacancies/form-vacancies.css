/* =========================
   Base + Tokens
========================= */
:host{
  display:block;

  --bg:#f6f7fb;
  --surface:#fff;
  --surface-2:#f9fafb;

  --text:#111827;
  --muted:#6b7280;

  --border:#e5e7eb;
  --border-2:#d1d5db;

  --r-lg:16px;
  --r-md:14px;
  --r-sm:12px;

  --gap-lg:12px;
  --gap-md:10px;

  --shadow-1:0 8px 24px rgba(17,24,39,.06);
  --shadow-2:0 10px 20px rgba(17,24,39,.06);
  --shadow-3:0 14px 28px rgba(17,24,39,.08);

  --pad-lg:14px;
  --pad-md:12px;
  --pad-sm:10px;

  --t-fast:150ms ease;

  /* ✅ NUEVOS: acento para títulos */
  --accent:#2563eb;
  --accent-soft: rgba(37, 99, 235, .10);
}

/* =========================
   Layout general
========================= */
.contenedor{
  min-height:100vh;
  padding:var(--pad-lg);
  background:var(--bg);
}

.head{
  max-width:1200px;
  margin:0 auto 12px auto;
  position:relative;
}
.head h1{
  margin:0;
  font-size:20px;
  font-weight:950;
  color:var(--text);
  letter-spacing:.2px;
}
.head h1::after{
  content:"";
  display:block;
  width:90px;
  height:3px;
  margin-top:8px;
  border-radius:999px;
  background:var(--accent);
  opacity:.9;
}

.fila1{
  max-width:1200px;
  margin:0 auto;
}

.formulario.formulario2{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:var(--r-lg);
  padding:var(--pad-lg);
  box-shadow:var(--shadow-1);
}

/* =========================
   TITULOS PRO (Step / Secciones)
========================= */

/* Step Title (bloque .title) */
.title{
  margin:10px 0 12px 0;
  padding:12px 12px;
  border:1px solid var(--border);
  border-radius:var(--r-lg);
  background: linear-gradient(180deg, rgba(255,255,255,1) 0%, rgba(249,250,251,1) 100%);
  box-shadow: 0 6px 16px rgba(17,24,39,.05);
  position:relative;
  overflow:hidden;
}
.title::before{
  content:"";
  position:absolute;
  left:0;
  top:0;
  width:100%;
  height:3px;
  background:var(--accent);
  opacity:.9;
}
.title::after{
  content:"";
  position:absolute;
  right:-60px;
  top:-60px;
  width:160px;
  height:160px;
  background:var(--accent-soft);
  border-radius:999px;
}

/* Título grande dentro del step */
.title h1{
  margin:0;
  font-size:18px;
  font-weight:950;
  color:var(--text);
  letter-spacing:.2px;
  display:flex;
  align-items:center;
  gap:10px;
}

/* Texto auxiliar debajo del step title */
.title p{
  margin:6px 0 0 0;
  font-size:12px;
  color:var(--muted);
  font-weight:650;
}

/* Jerarquía de títulos internos del formulario */
.formulario.formulario2 h2{
  margin:16px 0 8px 0 !important;
  padding:8px 10px;
  border-left:4px solid var(--accent);
  background:var(--accent-soft);
  border-radius:10px;
  font-size:14px;
  font-weight:950;
  color:var(--text);
  letter-spacing:.2px;
}

.formulario.formulario2 h3{
  margin:12px 0 8px 0 !important;
  padding:6px 10px;
  border-left:3px solid rgba(37,99,235,.55);
  background:rgba(37,99,235,.06);
  border-radius:10px;
  font-size:13px;
  font-weight:900;
  color:var(--text);
}

.formulario.formulario2 h4{
  margin:10px 0 8px 0 !important;
  font-size:13px;
  font-weight:900;
  color:var(--text);
  letter-spacing:.2px;
}

/* =========================
   Grid principal
========================= */
.datos{
  display:grid;
  grid-template-columns:repeat(4, minmax(0, 1fr));
  gap:var(--gap-lg);
  align-items:start;
}

.datos mat-form-field,
.datos .mat-mdc-form-field{
  width:100%;
  min-width:0;
}

/* Full width para bloques largos */
.example-full-width,
.input-container,
.edad-hijo-form-field,
.hermano-container,
[formArrayName]{
  grid-column:1 / -1;
}

/* Si soporta :has() expandir textarea */
@supports selector(:has(*)){
  .datos mat-form-field:has(textarea),
  .datos .mat-mdc-form-field:has(textarea),
  .ref-grid mat-form-field:has(textarea),
  .ref-grid .mat-mdc-form-field:has(textarea),
  .kid-grid mat-form-field:has(textarea),
  .kid-grid .mat-mdc-form-field:has(textarea){
    grid-column:1 / -1;
  }
}

/* Subgrids dentro de formArray */
[formArrayName] .datos{
  margin-top:8px;
  padding-top:8px;
  border-top:1px dashed var(--border);
}

/* Menú + campo PDF */
.input-container{
  display:grid;
  grid-template-columns:40px 1fr;
  gap:var(--gap-md);
  align-items:center;
}

/* =========================
   Stepper horizontal scroll
========================= */
.stepper-scroll{
  margin:0 calc(var(--pad-lg) * -1);
  padding:0 var(--pad-lg);
}

::ng-deep .stepper-scroll .mat-horizontal-stepper-header-container,
::ng-deep .stepper-scroll .mat-mdc-stepper-horizontal .mat-mdc-stepper-header-container{
  overflow-x:auto;
  overflow-y:hidden;
  white-space:nowrap;
  scrollbar-gutter:stable;
  padding:6px 0;
  gap:6px;
}

::ng-deep .stepper-scroll .mat-horizontal-stepper-header,
::ng-deep .stepper-scroll .mat-mdc-step-header{
  flex:0 0 auto;
  min-width:220px;
  padding:0 12px;
}

::ng-deep .stepper-scroll .mat-step-label,
::ng-deep .stepper-scroll .mat-mdc-step-label{
  white-space:nowrap;
}

::ng-deep .stepper-scroll .mat-horizontal-content-container,
::ng-deep .stepper-scroll .mat-mdc-stepper-horizontal .mat-mdc-stepper-content{
  padding:12px 0 0 0;
}

/* =========================
   Misc
========================= */
mat-progress-bar{
  border-radius:999px;
  overflow:hidden;
}

button[matButton]{
  border-radius:var(--r-sm);
}

/* =========================================================
   SECCIONES: Referencias / Hijos
========================================================= */
.datos.refs,
.datos.kids{
  grid-column:1 / -1;
  display:block;
  margin-top:10px;
  padding:12px;
  border:1px solid var(--border);
  border-radius:var(--r-lg);
  background:var(--surface);
  box-shadow:0 6px 18px rgba(17,24,39,.04);
}

/* Header de sección */
.datos.refs .section-head,
.datos.kids .section-head{
  display:flex;
  align-items:flex-end;
  justify-content:space-between;
  gap:12px;
  margin-bottom:10px;
  padding-bottom:10px;
  border-bottom:1px dashed var(--border);
}

.datos.refs .section-title,
.datos.kids .section-title{
  margin:0;
  font-size:14px;
  font-weight:900;
  color:var(--text);
  letter-spacing:.2px;
}

.datos.refs .section-subtitle,
.datos.kids .section-subtitle{
  margin:0;
  font-size:12px;
  color:var(--muted);
  font-weight:600;
}

/* =========================================================
   FIX DEFINITIVO PARA OUTLINE (refs + kids)
========================================================= */

/* 1) Tokens MDC para OUTLINE */
:host ::ng-deep .datos.refs .mat-mdc-form-field,
:host ::ng-deep .datos.kids .mat-mdc-form-field{
  --mdc-outlined-text-field-container-shape: 12px;
  --mdc-outlined-text-field-outline-color: var(--border);
  --mdc-outlined-text-field-hover-outline-color: var(--border-2);
  --mdc-outlined-text-field-label-text-size: 12px;
}

/* 2) Fondo suave dentro del outline (sin romper notch) */
:host ::ng-deep .datos.refs .mat-mdc-text-field-wrapper,
:host ::ng-deep .datos.kids .mat-mdc-text-field-wrapper{
  background: var(--surface-2);
  border-radius: 12px;
}

/* 3) Alto estable del campo y alineación vertical */
:host ::ng-deep .datos.refs .mat-mdc-form-field-flex,
:host ::ng-deep .datos.kids .mat-mdc-form-field-flex{
  min-height: 56px;
  align-items: stretch;
}

/* 4) Infix con padding material-like */
:host ::ng-deep .datos.refs .mat-mdc-form-field-infix,
:host ::ng-deep .datos.kids .mat-mdc-form-field-infix{
  padding-top: 18px !important;
  padding-bottom: 10px !important;
  min-height: 56px;
  box-sizing: border-box;
}

/* 5) Compactar subscript */
:host ::ng-deep .datos.refs .mat-mdc-form-field-subscript-wrapper,
:host ::ng-deep .datos.kids .mat-mdc-form-field-subscript-wrapper{
  margin-top: 2px;
}

/* 6) Quita márgenes extra internos */
:host ::ng-deep .datos.refs .mat-mdc-form-field,
:host ::ng-deep .datos.kids .mat-mdc-form-field{
  margin:0;
}

/* =========================
   Referencias
========================= */
.refs-wrap{
  display:grid;
  grid-template-columns:repeat(2, minmax(0, 1fr));
  gap:var(--gap-lg);
}

.ref-box{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:var(--r-lg);
  padding:12px;
  box-shadow:var(--shadow-2);
  transition:transform var(--t-fast), box-shadow var(--t-fast), border-color var(--t-fast);
}

@media (hover:hover){
  .ref-box:hover{
    transform:translateY(-1px);
    border-color:var(--border-2);
    box-shadow:var(--shadow-3);
  }
}

.ref-box__header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  margin-bottom:10px;
}

.ref-box__subtitle{
  font-size:12px;
  font-weight:700;
  color:var(--muted);
  white-space:nowrap;
}

.ref-badge{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:6px 10px;
  border-radius:999px;
  font-size:12px;
  font-weight:900;
  letter-spacing:.2px;
  border:1px solid transparent;
  line-height:1;
}

.ref-badge--personal{
  background:#eef2ff;
  color:#3730a3;
  border-color:#e0e7ff;
}
.ref-badge--familiar{
  background:#ecfdf5;
  color:#065f46;
  border-color:#d1fae5;
}

.ref-grid{
  display:grid;
  grid-template-columns:repeat(2, minmax(0, 1fr));
  gap:var(--gap-md);
  align-items:start;
}

.ref-grid mat-form-field,
.ref-grid .mat-mdc-form-field{
  width:100%;
  min-width:0;
}

/* =========================
   Hijos
========================= */
.kids-controls{
  display:grid;
  grid-template-columns:repeat(2, minmax(0, 1fr));
  gap:var(--gap-lg);
  margin-bottom:10px;
}

.kids-ages{
  display:grid;
  grid-template-columns:repeat(4, minmax(0, 1fr));
  gap:var(--gap-md);
  margin-bottom:10px;
}

.kids-wrap{
  display:grid;
  grid-template-columns:repeat(2, minmax(0, 1fr));
  gap:var(--gap-lg);
}

.kid-box{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:var(--r-lg);
  padding:12px;
  box-shadow:var(--shadow-2);
  transition:transform var(--t-fast), box-shadow var(--t-fast), border-color var(--t-fast);
}

@media (hover:hover){
  .kid-box:hover{
    transform:translateY(-1px);
    border-color:var(--border-2);
    box-shadow:var(--shadow-3);
  }
}

.kid-box__header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  margin-bottom:10px;
}

.kid-badge{
  display:inline-flex;
  align-items:center;
  padding:6px 10px;
  border-radius:999px;
  font-size:12px;
  font-weight:900;
  letter-spacing:.2px;
  background:#fef3c7;
  border:1px solid #fde68a;
  color:#92400e;
  line-height:1;
}

.kid-box__subtitle{
  font-size:12px;
  font-weight:700;
  color:var(--muted);
  white-space:nowrap;
}

.kid-grid{
  display:grid;
  grid-template-columns:repeat(2, minmax(0, 1fr));
  gap:var(--gap-md);
}

.kid-grid mat-form-field,
.kid-grid .mat-mdc-form-field{
  width:100%;
  min-width:0;
}

/* =========================
   Breakpoints
========================= */
@media (max-width:1200px){
  .datos{ grid-template-columns:repeat(3, minmax(0, 1fr)); }
  .kids-ages{ grid-template-columns:repeat(3, minmax(0, 1fr)); }
}

@media (max-width:900px){
  .contenedor{ padding:var(--pad-md); }
  .formulario.formulario2{ padding:var(--pad-md); border-radius:var(--r-md); }

  .datos{
    grid-template-columns:repeat(2, minmax(0, 1fr));
    gap:var(--gap-md);
  }

  .stepper-scroll{
    margin:0 calc(var(--pad-md) * -1);
    padding:0 var(--pad-md);
  }

  ::ng-deep .stepper-scroll .mat-horizontal-stepper-header,
  ::ng-deep .stepper-scroll .mat-mdc-step-header{
    min-width:200px;
  }

  .refs-wrap{ grid-template-columns:1fr; }
  .kids-controls{ grid-template-columns:1fr; gap:var(--gap-md); }
  .kids-ages{ grid-template-columns:repeat(2, minmax(0, 1fr)); }
  .kids-wrap{ grid-template-columns:1fr; }
}

@media (max-width:600px){
  .head h1{ font-size:18px; }
  .head h1::after{ width:70px; }

  .formulario.formulario2{ padding:var(--pad-sm); border-radius:var(--r-md); }

  .title{
    padding:10px 10px;
    border-radius:var(--r-md);
  }
  .title h1{ font-size:16px; }

  .datos{
    grid-template-columns:1fr;
    gap:var(--gap-md);
  }

  .input-container{ grid-template-columns:1fr; }
  .input-container button[mat-icon-button]{ justify-self:end; }

  .stepper-scroll{
    margin:0 calc(var(--pad-sm) * -1);
    padding:0 var(--pad-sm);
  }

  ::ng-deep .stepper-scroll .mat-horizontal-stepper-header,
  ::ng-deep .stepper-scroll .mat-mdc-step-header{
    min-width:190px;
  }

  .datos.refs,
  .datos.kids{
    padding:10px;
    border-radius:var(--r-md);
  }

  .datos.refs .section-head,
  .datos.kids .section-head{
    flex-direction:column;
    align-items:flex-start;
    gap:4px;
  }

  .ref-grid,
  .kid-grid{
    grid-template-columns:1fr;
  }

  .ref-box__subtitle,
  .kid-box__subtitle{
    white-space:normal;
  }

  .kids-ages{ grid-template-columns:1fr; }
}

@media (max-width:420px){
  .contenedor{ padding:var(--pad-sm); }
  .formulario.formulario2{ padding:var(--pad-sm); }
}
